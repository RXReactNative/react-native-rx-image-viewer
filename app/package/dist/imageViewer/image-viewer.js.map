{"version":3,"sources":["../../src/imageViewer/image-viewer.js"],"names":["React","Component","View","Text","Image","Animated","I18nManager","TouchableOpacity","TouchableHighlight","TouchableWithoutFeedback","UIManager","findNodeHandle","CameraRoll","RXImageViewerStyle","ImageZoom","ImageStyles","ImageViewerPropsType","ImageViewerDefaultProps","ImageViewer","constructor","props","resetImageByIndex","index","imageRefs","reset","saveImageSize","imageSizes","imageStatus","imageSizesStatus","slice","setState","preloadImage","state","imageSizesLength","length","loadImage","handleHorizontalOuterRangeOffset","offsetX","positionXNumber","standardPositionX","positionX","setValue","offsetXRTL","isRTL","currentShowIndex","imageUrls","handleResponderRelease","vx","vxRTL","isLeftMove","flipThreshold","isRightMove","goBack","call","goNext","resetPosition","width","timing","toValue","duration","pageAnimateTime","start","nextIndex","onChange","handleLongPress","image","saveToLocalByLongPress","isShowMenu","onLongPress","handleClick","onClick","handleCancel","handleDoubleClick","onDoubleClick","hasLayout","onCancel","handleLayout","event","nativeEvent","layout","height","styles","backgroundColor","forceUpdate","jumpToCurrentImage","saveToLocal","onSaveToCamera","onSave","saveToCameraRoll","uri","handleLeaveMenu","handleSwipeDown","onSwipeDown","relativeLocation","jsxElement","_that","console","warn","handle","measure","x","y","pageX","pageY","Math","ceil","fadeAnim","Value","configImageStyles","store","imageViewer","error","loadedIndex","Map","handleLongPressWithIndex","componentWillMount","init","componentWillReceiveProps","nextProps","forEach","imageUrl","push","status","has","set","imageSizesWidth","imageSizesHeight","sizeLoaded","imageLoaded","imageStartsWith","startsWith","enablePreload","prefetch","getSize","source","lastSource","data","resolveAssetSource","newError","getContent","loadingRender","renderImage","renderHeader","renderArrowLeft","renderArrowRight","renderIndicator","renderFooter","screenWidth","screenHeight","ImageElements","map","bind","imageInfo","widthPixel","HeightPixel","Wrapper","children","others","maxOverflow","onMove","get","enableSwipeDown","swipeDownThreshold","enableImageZoom","doubleClickInterval","modalContainer","loadingContainer","style","imageStyle","el","failImageSource","zIndex","container","opacity","arrowLeftContainer","arrowRightContainer","moveBox","transform","translateX","originSizeKb","originUrl","watchOrigin","watchOriginTouchable","watchOriginText","bottom","position","footerContainerStyle","getMenu","menus","menuContainer","cancel","underlayColor","menuShadow","menuContent","operateContainer","operateText","menuContext","render","childs","e","flex","overflow","defaultProps"],"mappings":"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","file":"image-viewer.js","sourcesContent":["/**\n * @this image-zoom.component\n * \n * @flow \n */\n'use strict'\nimport React, { Component } from 'react';\nimport {\n  View,\n  Text,\n  Image,\n  Animated,\n  // CameraRoll,\n  I18nManager,\n  TouchableOpacity,\n  TouchableHighlight,\n  TouchableWithoutFeedback,\n  UIManager,\n  findNodeHandle\n} from 'react-native';\n\nimport CameraRoll from \"@react-native-community/cameraroll\";\n\nimport RXImageViewerStyle from '../api/image-pan-zoom-style';\nimport ImageZoom from '../zoom/image-zoom';\nimport ImageStyles from './image-viewer.style';\nimport { ImageViewerPropsType, ImageViewerDefaultProps } from './image-viewer.type';\n\nexport default class ImageViewer extends React.Component {\n  static defaultProps = {\n    ...ImageViewerPropsType\n  };\n\n  static defaultProps = {\n\t\t...ImageViewerDefaultProps,\n  }\n  \n  constructor(props) {\n    super(props);\n    this.state = {\n      imageSizes: [],\n    }\n\n    // 背景透明度渐变动画\n    this.fadeAnim = new Animated.Value(0);\n\n    // 当前基准位置\n    this.standardPositionX = 0;\n\n    // 整体位移，用来切换图片用\n    this.positionXNumber = 0;\n    this.positionX = new Animated.Value(0);\n\n    this.width = 0;\n    this.height = 0;\n\n    let configImageStyles = null;\n    try {\n      configImageStyles = RXImageViewerStyle.store.imageViewer.ImageStyles;\n    } catch (error) {\n      configImageStyles = null;\n      console.warn('RXImageViewerStyle -> image-viewer.js -> constructor(props) -> configImageStyles error')\n    }\n\n    if (configImageStyles) { // 可以自定义样式，否则采用默认的样式\n      this.styles = configImageStyles;\n    }\n    else {\n      this.styles = ImageStyles;\n    }\n    \n    // 是否执行过 layout. fix 安卓不断触发 onLayout 的 bug\n    this.hasLayout = false;\n\n    // 记录已加载的图片 index =>  new Map<number, boolean>()\n    this.loadedIndex = new Map();\n\n    //new Map<number, any>()\n    this.handleLongPressWithIndex = new Map();\n\n    this.imageRefs = [];\n  }\n\n  componentWillMount() {\n    this.init(this.props);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.index !== this.state.currentShowIndex) {\n      this.setState(\n        {\n          currentShowIndex: nextProps.index\n        },\n        () => {\n          // 立刻预加载要看的图\n          this.loadImage(nextProps.index || 0);\n\n          this.jumpToCurrentImage();\n\n          // 显示动画\n          Animated.timing(this.fadeAnim, {\n            toValue: 1,\n            duration: 200\n          }).start();\n        }\n      );\n    }\n  }\n\n  /**\n   * props 有变化时执行\n   */\n  init(nextProps) { //type.Props\n    if (nextProps.imageUrls.length === 0) {\n      // 隐藏时候清空\n      this.fadeAnim.setValue(0);\n      return this.setState({imageSizes: []});\n    }\n\n    // 给 imageSizes 塞入空数组\n    const imageSizes = []; //type.IImageSize[]\n    nextProps.imageUrls.forEach(imageUrl => {\n      imageSizes.push({\n        width: imageUrl.width || 0,\n        height: imageUrl.height || 0,\n        status: 'loading'\n      });\n    });\n\n    this.setState(\n      {\n        currentShowIndex: nextProps.index,\n        imageSizes\n      },\n      () => {\n        // 立刻预加载要看的图\n        this.loadImage(nextProps.index || 0);\n\n        this.jumpToCurrentImage();\n\n        // 显示动画\n        Animated.timing(this.fadeAnim, {\n          toValue: 1,\n          duration: 200\n        }).start();\n      }\n    );\n  }\n  /**\n   * reset Image scale and position\n   */\n  resetImageByIndex = (index = 0) => {\n    this.imageRefs[index] && this.imageRefs[index].reset();\n  };\n  /**\n   * 调到当前看图位置\n   */\n  jumpToCurrentImage() {\n    // 跳到当前图的位置\n    this.positionXNumber = this.width * (this.state.currentShowIndex || 0) * (I18nManager.isRTL ? 1 : -1);\n    this.standardPositionX = this.positionXNumber;\n    this.positionX.setValue(this.positionXNumber);\n  }\n\n  // 保存 imageSize\n  saveImageSize = (index=0, imageSizes=[], imageStatus={}, imageSizesStatus='unknow') => {\n    // 如果已经 success 了，就不做处理\n    if (imageSizes[index] && imageSizesStatus !== 'loading') {\n      return;\n    }\n\n    imageSizes = imageSizes.slice();\n    imageSizes[index] = imageStatus;\n    this.setState({ imageSizes });\n  };\n  \n  /**\n   * 加载图片，主要是获取图片长与宽\n   */\n  loadImage(index = 0) {\n    let imageSizes = this.state.imageSizes || [];\n    let imageSizesLength = imageSizes.length || 0;\n    if (imageSizesLength <= index) return;\n\n    if (this.loadedIndex.has(index)) {\n      return;\n    }\n    this.loadedIndex.set(index, true);\n\n    const image = this.props.imageUrls[index];\n\n    const imageStatus = { ...imageSizes[index] };\n\n    let imageSizesStatus = imageSizes[index].status || 'unknow';\n\n    if (imageSizesStatus === 'success') {\n      // 已经加载过就不会加载了\n      return;\n    }\n\n    let imageSizesWidth = imageSizes[index].width || 0;\n    let imageSizesHeight = imageSizes[index].height || 0;\n\n    // 如果已经有宽高了，直接设置为 success\n    if (imageSizesWidth > 0 && imageSizesHeight > 0) {\n      imageStatus.status = 'success';\n      this.saveImageSize(index, imageSizes, imageStatus, imageSizesStatus);\n      return;\n    }\n\n    // 是否加载完毕了图片大小\n    const sizeLoaded = false;\n    // 是否加载完毕了图片\n    let imageLoaded = false;\n\n    // Tagged success if uri is started with file:, or not set yet(for custom source.uri).\n    let imageUrl = image.uri;\n    var imageStartsWith = null;\n    if (imageUrl && typeof imageUrl === 'string') {\n      //本地文件\n      if (imageUrl.startsWith(`file:`)) {\n        imageLoaded = true;\n      }\n      else if (imageUrl.startsWith(`ph:`)) {\n        imageLoaded = true;\n      }\n      else if (imageUrl.startsWith(`data:image/jpeg;base64,`)) {\n        imageLoaded = true;\n      }\n    }\n    if (image && (!imageUrl || imageStartsWith)) {\n      imageLoaded = true;\n    }\n\n    // 如果已知源图片宽高，直接设置为 success\n    if (image && image.width && image.height) {\n      if (this.props.enablePreload && imageLoaded === false) {\n        Image.prefetch(imageUrl);\n      }\n      imageStatus.width = image.width;\n      imageStatus.height = image.height;\n      imageStatus.status = 'success';\n      this.saveImageSize(index, imageSizes, imageStatus, imageSizesStatus);\n      return;\n    }\n\n    Image.getSize(\n      imageUrl,\n      (width = 0, height = 0) => {\n        imageStatus.width = width;\n        imageStatus.height = height;\n        imageStatus.status = 'success';\n        this.saveImageSize(index, imageSizes, imageStatus, imageSizesStatus);\n      },\n      () => {\n        try {\n          // 标签的 <Image /> \n          let props = image.props || {};\n          let source = props.source || null;\n          var lastSource = source;\n          if (!source && imageUrl) {\n            lastSource = imageUrl;\n          }\n          const data = Image.resolveAssetSource(lastSource);\n          imageStatus.width = data.width;\n          imageStatus.height = data.height;\n          imageStatus.status = 'success';\n          this.saveImageSize(index, imageSizes, imageStatus, imageSizesStatus);\n        } catch (newError) {\n          // Give up..\n          imageStatus.status = 'fail';\n          this.saveImageSize(index, imageSizes, imageStatus, imageSizesStatus);\n        }\n      }\n    );\n  }\n\n  /**\n   * 预加载图片\n   */\n  preloadImage = (index = 0) => {\n    let imageSizes = this.state.imageSizes || [];\n    let imageSizesLength = imageSizes.length || 0;\n    if (index < imageSizesLength) {\n      this.loadImage(index + 1);\n    }\n  };\n  /**\n   * 触发溢出水平滚动\n   */\n  handleHorizontalOuterRangeOffset = (offsetX = 0) => {\n    this.positionXNumber = this.standardPositionX + offsetX;\n    this.positionX.setValue(this.positionXNumber);\n\n    const offsetXRTL = !I18nManager.isRTL ? offsetX : -offsetX;\n\n    let currentShowIndex = this.state.currentShowIndex || 0;\n\n    if (offsetXRTL < 0) {\n      if (currentShowIndex || 0 < this.props.imageUrls.length - 1) {\n        this.loadImage((currentShowIndex || 0) + 1);\n      }\n    } else if (offsetXRTL > 0) {\n      if (currentShowIndex || 0 > 0) {\n        this.loadImage((currentShowIndex || 0) - 1);\n      }\n    }\n  };\n\n  /**\n   * 手势结束，但是没有取消浏览大图\n   */\n  handleResponderRelease = (vx = 0) => {\n    const vxRTL = I18nManager.isRTL ? -vx : vx;\n    const isLeftMove = I18nManager.isRTL\n      ? this.positionXNumber - this.standardPositionX < -(this.props.flipThreshold || 0)\n      : this.positionXNumber - this.standardPositionX > (this.props.flipThreshold || 0);\n    const isRightMove = I18nManager.isRTL\n      ? this.positionXNumber - this.standardPositionX > (this.props.flipThreshold || 0)\n      : this.positionXNumber - this.standardPositionX < -(this.props.flipThreshold || 0);\n\n    if (vxRTL > 0.7) {\n      // 上一张\n      this.goBack.call(this);\n\n      // 这里可能没有触发溢出滚动，为了防止图片不被加载，调用加载图片\n      if (this.state.currentShowIndex || 0 > 0) {\n        this.loadImage((this.state.currentShowIndex || 0) - 1);\n      }\n      return;\n    } else if (vxRTL < -0.7) {\n      // 下一张\n      this.goNext.call(this);\n      if (this.state.currentShowIndex || 0 < this.props.imageUrls.length - 1) {\n        this.loadImage((this.state.currentShowIndex || 0) + 1);\n      }\n      return;\n    }\n\n    if (isLeftMove) {\n      // 上一张\n      this.goBack.call(this);\n    } else if (isRightMove) {\n      // 下一张\n      this.goNext.call(this);\n      return;\n    } else {\n      // 回到之前的位置\n      this.resetPosition.call(this);\n      return;\n    }\n  };\n\n  /**\n   * 到上一张\n   */\n  goBack = () => {\n    if (this.state.currentShowIndex === 0) {\n      // 回到之前的位置\n      this.resetPosition.call(this);\n      return;\n    }\n\n    this.positionXNumber = !I18nManager.isRTL\n      ? this.standardPositionX + this.width\n      : this.standardPositionX - this.width;\n    this.standardPositionX = this.positionXNumber;\n    Animated.timing(this.positionX, {\n      toValue: this.positionXNumber,\n      duration: this.props.pageAnimateTime\n    }).start();\n\n    const nextIndex = (this.state.currentShowIndex || 0) - 1;\n\n    this.setState(\n      {\n        currentShowIndex: nextIndex\n      },\n      () => {\n        if (this.props.onChange) {\n          this.props.onChange(this.state.currentShowIndex);\n        }\n      }\n    );\n  };\n\n  /**\n   * 到下一张\n   */\n  goNext = () => {\n    if (this.state.currentShowIndex === this.props.imageUrls.length - 1) {\n      // 回到之前的位置\n      this.resetPosition.call(this);\n      return;\n    }\n\n    this.positionXNumber = !I18nManager.isRTL\n      ? this.standardPositionX - this.width\n      : this.standardPositionX + this.width;\n    this.standardPositionX = this.positionXNumber;\n    Animated.timing(this.positionX, {\n      toValue: this.positionXNumber,\n      duration: this.props.pageAnimateTime\n    }).start();\n\n    const nextIndex = (this.state.currentShowIndex || 0) + 1;\n\n    this.setState(\n      {\n        currentShowIndex: nextIndex\n      },\n      () => {\n        if (this.props.onChange) {\n          this.props.onChange(this.state.currentShowIndex);\n        }\n      }\n    );\n  };\n\n  /**\n   * 回到原位\n   */\n  resetPosition() {\n    this.positionXNumber = this.standardPositionX;\n    Animated.timing(this.positionX, {\n      toValue: this.standardPositionX,\n      duration: 150\n    }).start();\n  }\n\n  /**\n   * 长按\n   */\n  handleLongPress = (image) => { //image = type.IImageInfo\n    if (this.props.saveToLocalByLongPress) {\n      // 出现保存到本地的操作框\n      this.setState({ isShowMenu: true });\n    }\n\n    if (this.props.onLongPress) {\n      this.props.onLongPress(image);\n    }\n  };\n\n  /**\n   * 单击\n   */\n  handleClick = () => {\n    if (this.props.onClick) {\n      this.props.onClick(this.handleCancel, this.state.currentShowIndex);\n    }\n  };\n\n  /**\n   * 双击\n   */\n  handleDoubleClick = () => {\n    if (this.props.onDoubleClick) {\n      this.props.onDoubleClick(this.handleCancel);\n    }\n  };\n\n  /**\n   * 退出\n   */\n  handleCancel = () => {\n    this.hasLayout = false;\n    if (this.props.onCancel) {\n      this.props.onCancel();\n    }\n  };\n\n  /**\n   * 完成布局\n   */\n  handleLayout = (event) => { //LayoutChangeEvent\n    if (!event) return;\n    if (event.nativeEvent.layout.width !== this.width) {\n      this.hasLayout = true;\n\n      this.width = event.nativeEvent.layout.width;\n      this.height = event.nativeEvent.layout.height;\n      this.styles = ImageStyles(this.width, this.height, this.props.backgroundColor || 'transparent');\n\n      // 强制刷新\n      this.forceUpdate();\n      this.jumpToCurrentImage();\n    }\n  };\n\n  /**\n   * 获得整体内容\n   */\n  getContent() {\n\n    // func\n    let { loadingRender ,renderImage, renderHeader, renderArrowLeft, renderArrowRight, renderIndicator, renderFooter } = this.props; \n    loadingRender = loadingRender || null;\n    renderImage = renderImage || null;\n    renderHeader = renderHeader || null;\n    renderArrowLeft = renderArrowLeft || null;\n    renderArrowRight = renderArrowRight || null;\n    renderIndicator = renderIndicator || null;\n    renderFooter = renderFooter || null;\n\n    // 获得屏幕宽高\n    const screenWidth = this.width;\n    const screenHeight = this.height;\n\n    const ImageElements = this.props.imageUrls.map((image, index) => {\n      if ((this.state.currentShowIndex || 0) > index + 1 || (this.state.currentShowIndex || 0) < index - 1) {\n        return <View key={index} style={{ width: screenWidth, height: screenHeight }} />;\n      }\n\n      if (!this.handleLongPressWithIndex.has(index)) {\n        this.handleLongPressWithIndex.set(index, this.handleLongPress.bind(this, image));\n      }\n\n      let imageSizes = this.state.imageSizes || {};\n\n      let width = imageSizes[index] && imageSizes[index].width;\n      let height = imageSizes[index] && imageSizes[index].height;\n      const imageInfo = imageSizes[index];\n\n      if (!imageInfo || !imageInfo.status) {\n        return <View key={index} style={{ width: screenWidth, height: screenHeight }} />;\n      }\n\n      // 如果宽大于屏幕宽度,整体缩放到宽度是屏幕宽度\n      if (width > screenWidth) {\n        const widthPixel = screenWidth / width;\n        width *= widthPixel;\n        height *= widthPixel;\n      }\n\n      // 如果此时高度还大于屏幕高度,整体缩放到高度是屏幕高度\n      if (height > screenHeight) {\n        const HeightPixel = screenHeight / height;\n        width *= HeightPixel;\n        height *= HeightPixel;\n      }\n\n      const Wrapper = ({ children, ...others }) => (\n        <ImageZoom\n          cropWidth={this.width}\n          cropHeight={this.height}\n          maxOverflow={this.props.maxOverflow}\n          horizontalOuterRangeOffset={this.handleHorizontalOuterRangeOffset}\n          responderRelease={this.handleResponderRelease}\n          onMove={this.props.onMove}\n          onLongPress={this.handleLongPressWithIndex.get(index)}\n          onClick={this.handleClick}\n          onDoubleClick={this.handleDoubleClick}\n          enableSwipeDown={this.props.enableSwipeDown}\n          swipeDownThreshold={this.props.swipeDownThreshold}\n          onSwipeDown={this.handleSwipeDown}\n          pinchToZoom={this.props.enableImageZoom}\n          enableDoubleClickZoom={this.props.enableImageZoom}\n          doubleClickInterval={this.props.doubleClickInterval}\n          {...others}\n        >\n          {children}\n        </ImageZoom>\n      );\n\n      switch (imageInfo.status) {\n        case 'loading':\n          return (\n            <Wrapper\n              key={index}\n              style={{\n                ...this.styles.modalContainer,\n                ...this.styles.loadingContainer\n              }}\n              imageWidth={screenWidth}\n              imageHeight={screenHeight}\n            >\n              <View style={this.styles.loadingContainer}>{loadingRender && loadingRender()}</View>\n            </Wrapper>\n          );\n        case 'success':\n          if (!image.props) {\n            image.props = {};\n          }\n\n          if (!image.props.style) {\n            image.props.style = {};\n          }\n          image.props.style = {\n            ...this.styles.imageStyle, // User config can override above.\n            ...image.props.style,\n            width,\n            height\n          };\n\n          if (typeof image.props.source === 'number') {\n            // source = require(..), doing nothing\n          } else {\n            if (!image.props.source) {\n              image.props.source = {};\n            }\n            image.props.source = {\n              uri: image.uri,\n              ...image.props.source\n            };\n          }\n          if (this.props.enablePreload) {\n            this.preloadImage(this.state.currentShowIndex || 0);\n          }\n          return (\n            <ImageZoom\n              key={index}\n              ref={el => (this.imageRefs[index] = el)}\n              cropWidth={this.width}\n              cropHeight={this.height}\n              maxOverflow={this.props.maxOverflow}\n              horizontalOuterRangeOffset={this.handleHorizontalOuterRangeOffset}\n              responderRelease={this.handleResponderRelease}\n              onMove={this.props.onMove}\n              onLongPress={this.handleLongPressWithIndex.get(index)}\n              onClick={this.handleClick}\n              onDoubleClick={this.handleDoubleClick}\n              imageWidth={width}\n              imageHeight={height}\n              enableSwipeDown={this.props.enableSwipeDown}\n              swipeDownThreshold={this.props.swipeDownThreshold}\n              onSwipeDown={this.handleSwipeDown}\n              panToMove={!this.state.isShowMenu}\n              pinchToZoom={this.props.enableImageZoom && !this.state.isShowMenu}\n              enableDoubleClickZoom={this.props.enableImageZoom && !this.state.isShowMenu}\n              doubleClickInterval={this.props.doubleClickInterval}\n            >\n              {renderImage && renderImage(image.props)}\n            </ImageZoom>\n          );\n        case 'fail':\n          return (\n            <Wrapper\n              key={index}\n              style={this.styles.modalContainer}\n              imageWidth={this.props.failImageSource ? this.props.failImageSource.width : screenWidth}\n              imageHeight={this.props.failImageSource ? this.props.failImageSource.height : screenHeight}\n            >\n              {this.props.failImageSource && renderImage &&\n                renderImage({\n                  source: {\n                    uri: this.props.failImageSource.uri\n                  },\n                  style: {\n                    width: this.props.failImageSource.width,\n                    height: this.props.failImageSource.height\n                  }\n                })}\n            </Wrapper>\n          );\n      }\n    });\n\n    return (\n      <Animated.View style={{ zIndex: 9 }}>\n        <Animated.View style={{ ...this.styles.container, opacity: this.fadeAnim }}>\n          {renderHeader && renderHeader(this.state.currentShowIndex)}\n\n          <View style={this.styles.arrowLeftContainer}>\n            <TouchableWithoutFeedback onPress={this.goBack}>\n              <View>{renderArrowLeft && renderArrowLeft()}</View>\n            </TouchableWithoutFeedback>\n          </View>\n\n          <View style={this.styles.arrowRightContainer}>\n            <TouchableWithoutFeedback onPress={this.goNext}>\n              <View>{renderArrowRight && renderArrowRight()}</View>\n            </TouchableWithoutFeedback>\n          </View>\n\n          <Animated.View\n            style={{\n              ...this.styles.moveBox,\n              transform: [{ translateX: this.positionX }],\n              width: this.width * this.props.imageUrls.length\n            }}\n          >\n            {ImageElements}\n          </Animated.View>\n          {renderIndicator && renderIndicator((this.state.currentShowIndex || 0) + 1, this.props.imageUrls.length)}\n\n          {this.props.imageUrls[this.state.currentShowIndex || 0] &&\n            this.props.imageUrls[this.state.currentShowIndex || 0].originSizeKb &&\n            this.props.imageUrls[this.state.currentShowIndex || 0].originUrl && (\n              <View style={this.styles.watchOrigin}>\n                <TouchableOpacity style={this.styles.watchOriginTouchable}>\n                  <Text style={this.styles.watchOriginText}>查看原图(2M)</Text>\n                </TouchableOpacity>\n              </View>\n            )}\n          <View style={[{ bottom: 0, position: 'absolute', zIndex: 9 }, this.props.footerContainerStyle]}>\n            {renderFooter && renderFooter(this.state.currentShowIndex || 0)}\n          </View>\n        </Animated.View>\n      </Animated.View>\n    );\n  }\n\n  /**\n   * 保存当前图片到本地相册\n   */\n  saveToLocal = () => {\n    let { onSaveToCamera } = this.props;\n    onSaveToCamera = onSaveToCamera || null;\n\n    if (!this.props.onSave) {\n      CameraRoll.saveToCameraRoll(this.props.imageUrls[this.state.currentShowIndex || 0].uri);\n      onSaveToCamera && onSaveToCamera(this.state.currentShowIndex);\n    } else {\n      this.props.onSave(this.props.imageUrls[this.state.currentShowIndex || 0].uri);\n    }\n\n    this.setState({ isShowMenu: false });\n  };\n\n  getMenu() {\n    if (!this.state.isShowMenu) {\n      return null;\n    }\n\n    if (this.props.menus) {\n      return (\n        <View style={this.styles.menuContainer}>\n          {this.props.menus({ cancel: this.handleLeaveMenu, saveToLocal: this.saveToLocal })}\n        </View>\n      );\n    }\n\n    let underlayColor = \"#F2F2F2\";\n    try {\n      underlayColor = RXImageViewerStyle.store.imageViewer.underlayColor || \"#F2F2F2\";\n    } catch (error) {\n      console.warn('RXImageViewerStyle -> image-viewer.js -> getMenu -> underlayColor error')\n    }\n    \n    return (\n      <View style={this.styles.menuContainer}>\n        <View style={this.styles.menuShadow} />\n        <View style={this.styles.menuContent}>\n          <TouchableHighlight underlayColor={underlayColor} onPress={this.saveToLocal} style={this.styles.operateContainer}>\n            <Text style={this.styles.operateText}>{this.props.menuContext.saveToLocal}</Text>\n          </TouchableHighlight>\n          <TouchableHighlight\n            underlayColor={underlayColor}\n            onPress={this.handleLeaveMenu}\n            style={this.styles.operateContainer}\n          >\n            <Text style={this.styles.operateText}>{this.props.menuContext.cancel}</Text>\n          </TouchableHighlight>\n        </View>\n      </View>\n    );\n  }\n\n  handleLeaveMenu = () => {\n    this.setState({ isShowMenu: false });\n  };\n\n  handleSwipeDown = () => {\n    if (this.props.onSwipeDown) {\n      this.props.onSwipeDown();\n    }\n    this.handleCancel();\n  };\n\n  relativeLocation = (jsxElement) => {\n    let _that = this;\n    if (!jsxElement){\n      console.warn('RXImageViewerStyle -> relativeLocation-> jsxElement = null')\n      return;\n    }\n    const handle = findNodeHandle(jsxElement);\n    UIManager.measure(handle,(x, y, width, height, pageX, pageY)=>{\n      x = Math.ceil(x);\n      y = Math.ceil(y);\n      width = Math.ceil(width);\n      height = Math.ceil(height);\n      pageX = Math.ceil(pageX);\n      pageY = Math.ceil(pageY);\n      if (!x && !y && !width && !height) return;\n      let layout = { x, y, width, height};\n      var nativeEvent = {layout};\n      var event = {nativeEvent};\n      _that && _that.handleLayout && _that.handleLayout(event);\n    })\n  }\n\n  render() {\n    let childs = null; // React.ReactElement<any>\n\n    childs = (\n      <View>\n        {this.getContent()}\n        {this.getMenu()}\n      </View>\n    );\n\n    return (\n      <View\n        // onLayout={this.handleLayout}\n        ref={(e)=> {if (!e) return; this.relativeLocation(e)}}\n        style={{\n          flex: 1,\n          overflow: 'hidden',\n          ...this.props.style\n        }}\n      >\n        {childs}\n      </View>\n    );\n  }\n}\n"]}